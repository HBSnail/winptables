Dim outputRouteInfo As IntPtr = Marshal.AllocHGlobal(104)
                        Dim bestSrcIP As IntPtr = Marshal.AllocHGlobal(28)
                        Dim x As Integer = GetBestRoute2(IntPtr.Zero, 0, IntPtr.Zero, dstIP, 0, outputRouteInfo, bestSrcIP)
                        Marshal.FreeHGlobal(bestSrcIP)

                        If x <> 0 Then
                            Marshal.FreeHGlobal(outputRouteInfo)
                            Return
                        End If

                        Dim origin As Integer = Marshal.ReadInt32(outputRouteInfo + 100)
                        Dim loopback As Byte = Marshal.ReadByte(outputRouteInfo + 92)
                        Dim protocol As Integer = Marshal.ReadInt32(outputRouteInfo + 88)
                        Dim interfaceIndex As Integer = Marshal.ReadInt32(outputRouteInfo + 8)
                        Dim family As AddressFamily = Marshal.ReadInt32(outputRouteInfo + 44)
                        Dim nexthopIPByte() As Byte
                        If family = AddressFamily.InterNetwork Then
                            nexthopIPByte = New Byte(3) {}
                            Marshal.Copy(outputRouteInfo + 48, nexthopIPByte, 0, 4)
                        Else
                            nexthopIPByte = New Byte(15) {}
                            Marshal.Copy(outputRouteInfo + 52, nexthopIPByte, 0, 16)
                        End If
                        Marshal.FreeHGlobal(outputRouteInfo)